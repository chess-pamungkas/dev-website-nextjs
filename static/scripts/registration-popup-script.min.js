"use strict";const urlParams=new URLSearchParams(window.location.search),RTL_LANGUAGES=["ar"];!function(){window.OqtimaRegistration={};let t="";const e=(()=>{try{const t=document.getElementsByTagName("script"),e=Array.from(t).find(t=>t.src.includes("registration-popup-script.js"));if(e&&e.src){const t=new URL(e.src);return`${t.origin}/`}}catch(t){console.warn("[OQtima] Error determining API URL from script:",t)}const t=window.location.hostname;return"file:"===window.location.protocol||"localhost"===t||"127.0.0.1"===t?"http://localhost:8000/":"dev.oqt-ima.com"===t?"https://dev.oqt-ima.com/":"test.oqt-ima.com"===t?"https://test.oqt-ima.com/":"oqtima.com"===t||"lp.oqtima.com"===t||"www.oqtima.com"===t?"https://oqtima.com/":`${window.location.origin}/`})();t=(()=>{try{const t=document.getElementsByTagName("script"),e=["registration-popup-script.js","registration-popup-script.min.js"],n=Array.from(t).find(t=>{const n=t.src||"";return e.some(t=>n.includes(t))});if(n&&n.src){const t=new URL(n.src).origin;if(t.includes("localhost")||t.includes("127.0.0.1"))return"http://localhost:3000/";if(t.includes("dev.oqt-ima.com"))return"https://dev-back.oqt-ima.com/";if(t.includes("test.oqt-ima.com"))return"https://back.oqt-ima.com/";if(t.includes("oqtima.com"))return"https://back.oqtima.com/";try{const e=new URL(t);if(e.hostname.includes(".")){const t=e.hostname.split(".");return t.length>2?(t[0]="back",`${e.protocol}//${t.join(".")}/`):`${e.protocol}//back.${e.hostname}/`}}catch(t){console.warn("[OQtima] Error constructing backend URL from script origin:",t)}}}catch(t){console.warn("[OQtima] Error determining backend API URL from script:",t)}const t=window.location.hostname,e=window.location.protocol,n=window.location.port;return"file:"===e?"http://localhost:3000/":"localhost"===t||"127.0.0.1"===t?"8000"===n||"80"===n||""===n?"http://localhost:3000/":n?`http://localhost:${n}/`:"http://localhost:3000/":"dev.oqt-ima.com"===t?"https://dev-back.oqt-ima.com/":"test.oqt-ima.com"===t?"https://back.oqt-ima.com/":"oqtima.com"===t||"lp.oqtima.com"===t||"www.oqtima.com"===t?"https://back.oqtima.com/":(console.warn("[OQtima] Could not determine backend API URL from hostname or script, using default"),"https://dev-back.oqt-ima.com/")})();const n=(()=>{try{const t=document.getElementsByTagName("script"),e=["registration-popup-script.js","registration-popup-script.min.js"],n=Array.from(t).find(t=>{const n=t.src||"";return e.some(t=>n.includes(t))});if(n&&n.src){const t=new URL(n.src).origin;if(t.includes("localhost")||t.includes("127.0.0.1"))return"development";if(t.includes("dev.oqt-ima.com"))return"development";if(t.includes("test.oqt-ima.com"))return"staging";if(t.includes("oqtima.com"))return"production"}}catch(t){console.warn("[OQtima] Error determining environment from script:",t)}const t=window.location.hostname;return"file:"!==window.location.protocol&&t?"localhost"===t||"127.0.0.1"===t||"dev.oqt-ima.com"===t?"development":"test.oqt-ima.com"===t?"staging":"oqtima.com"===t||"lp.oqtima.com"===t||"www.oqtima.com"===t?"production":(console.warn("[OQtima] Could not determine environment, defaulting to development"),"development"):"development"})();let o=!1;const r={originalHtmlDir:null,originalBodyDir:null,originalHtmlLang:null,originalHtmlRtl:null,originalBodyRtl:null,originalHtmlClasses:null,originalBodyClasses:null};async function a(){try{const{apiKey:e}=await async function(){try{const t=document.getElementsByTagName("script"),e=["registration-popup-script.js","registration-popup-script.min.js"],n=Array.from(t).find(t=>{const n=t.src||"";return e.some(t=>n.includes(t))});if(!n)return console.warn("[OQtima] Script tag not found"),{apiKey:null};return{apiKey:n.getAttribute("data-api-key")}}catch(t){return console.error("[OQtima] Error retrieving API key:",t),{apiKey:null}}}();if(!e)return void i("API key is missing. Add data-api-key attribute to the script tag.");try{const r=await async function(e){try{const n=`${t}verify-api-key`,o=new AbortController,r=setTimeout(()=>o.abort(),1e4),a=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest",Origin:window.location.origin},body:JSON.stringify({apiKey:e}),credentials:"same-origin",mode:"cors",signal:o.signal,cache:"no-cache"}).finally(()=>clearTimeout(r));if(!a.ok){const t=await a.text();return console.error(`[OQtima] API key verification failed: ${a.status} ${t}`),!1}return!0===(await a.json()).isValid}catch(t){return"TypeError"===t.name&&t.message.includes("Failed to fetch")&&console.error("[OQtima] Network error verifying API key. This may indicate:","\n1. The backend server is not running or unreachable","\n2. CORS policy blocking the request","\n3. Network connectivity issues"),console.error("[OQtima] Error verifying API key:",t),!1}}(e);r?(o=!0,function(){(function(){const t=document.getElementById("oqtima-registration-styles");t&&t.remove();const e=document.createElement("style");e.id="oqtima-registration-styles";const n="\n      /* Trigger elements with data-oqtima-trigger attribute */\n      [data-oqtima-trigger] {\n        cursor: pointer !important;\n      }\n      \n      /* Button styling for trigger elements */\n      button[data-oqtima-trigger] {\n          position: relative !important;\n        transition: all 0.3s ease !important;\n      }\n      \n      /* Link styling for trigger elements */\n      a[data-oqtima-trigger] {\n          position: relative !important;\n        display: inline-block !important;\n      }\n      \n      /* Enhance trigger elements on hover */\n      [data-oqtima-trigger]:hover {\n        opacity: 0.9 !important;\n      }\n      \n      /* Mobile styles for popup */\n        .popup-registration__container {\n        flex: 1 1 auto !important;\n          position: relative !important;\n          width: 100% !important;\n        overflow-y: auto !important;\n        overflow-x: hidden !important;\n        -webkit-overflow-scrolling: touch !important;\n          padding: 0 !important;\n        background: #fff !important;\n        z-index: 1 !important;\n          display: flex !important;\n          flex-direction: column !important;\n        }\n\n        .popup-registration__content {\n          flex: 1 1 auto !important;\n          position: relative !important;\n          width: 100% !important;\n          overflow-y: auto !important;\n          overflow-x: hidden !important;\n          -webkit-overflow-scrolling: touch !important;\n          padding: 0 !important;\n          background: #fff !important;\n          z-index: 1 !important;\n          display: flex !important;\n          flex-direction: column !important;\n        }\n\n        .popup-registration__iframe-container {\n          flex: 1 1 auto !important;\n          position: relative !important;\n          width: 100% !important;\n          height: auto !important;\n          min-height: 0 !important;\n          overflow: hidden !important;\n        }\n\n        #oqtima-registration-iframe {\n          position: absolute !important;\n          top: 0 !important;\n          left: 0 !important;\n          right: 0 !important;\n          bottom: 0 !important;\n          width: 100% !important;\n          height: 100% !important;\n          border: none !important;\n          margin: 0 !important;\n          padding: 0 !important;\n          overflow: auto !important;\n          -webkit-overflow-scrolling: touch !important;\n        }\n\n        /* Fix iOS scrolling */\n        .popup-registration__content {\n          -webkit-overflow-scrolling: touch !important;\n          overscroll-behavior-y: contain !important;\n          transform: translate3d(0,0,0) !important;\n          -webkit-transform: translate3d(0,0,0) !important;\n        }\n\n        /* Prevent body scroll */\n        body.popup-open {\n          position: fixed !important;\n          width: 100% !important;\n          height: 100% !important;\n          overflow: hidden !important;\n          touch-action: none !important;\n        }\n\n        /* Fix dropdown positioning */\n        .custom-dropdown__content {\n          position: fixed !important;\n          top: 50% !important;\n          left: 50% !important;\n          transform: translate(-50%, -50%) !important;\n          width: 90% !important;\n          max-height: 80vh !important;\n          overflow-y: auto !important;\n          -webkit-overflow-scrolling: touch !important;\n          background: white !important;\n          border-radius: 8px !important;\n          box-shadow: 0 2px 10px rgba(0,0,0,0.1) !important;\n          z-index: 2147483648 !important;\n        }\n      }\n\n      /* Tablet */\n      @media screen and (min-width: 768px) {\n        .popup-registration__container {\n          width: 90% !important;\n          max-height: 85vh !important;\n        }\n\n        .popup-registration__iframe-container {\n          width: 100% !important;\n          height: 85vh !important;\n          max-height: 85vh !important;\n        }\n      }\n      \n      /* Large desktop */\n      @media screen and (min-width: 1024px) {\n        .popup-registration__container {\n          width: 1080px !important;\n          max-width: 1080px !important;\n          max-height: 90vh !important;\n        }\n\n        .popup-registration__iframe-container {\n          height: 47rem !important;\n          max-width: 73.25rem !important;\n          max-height: 47rem !important;\n        }\n      }\n      \n      /* Xtra Large desktop */\n      @media screen and (min-width: 1920px) {\n        .popup-registration__container {\n          max-height: 80vh !important;\n        }\n\n        .popup-registration__iframe-container {\n          height: 47rem !important;\n          max-width: 73rem !important;\n          max-height: 47rem !important;\n        }\n      }\n      \n      /* Mobile landscape */\n      @media screen and (max-width: 991px) and (orientation: landscape) {\n        .popup-registration__container {\n          width: 90% !important;\n          max-width: 90% !important;\n          max-height: 90vh !important;\n        }\n\n        .popup-registration__iframe-container {\n          width: 90% !important;\n          height: 90vh !important;\n          max-width: 90% !important;\n          max-height: 90vh !important;\n          min-height: auto !important;\n        }\n      }\n    ";e.appendChild(document.createTextNode(n)),document.head.appendChild(e)})(),function(){const t=document.querySelectorAll("[data-oqtima-trigger]");if(0===t.length)return;let e="en";try{if(sessionStorage.getItem("oqtima_tab_language"))e=sessionStorage.getItem("oqtima_tab_language");else if(document.documentElement.lang)e=document.documentElement.lang.toLowerCase();else if(window.location.pathname){const t=window.location.pathname.split("/").filter(Boolean);t.length>0&&/^[a-z]{2}(-[a-z]{2})?$/.test(t[0])&&(e=t[0].toLowerCase())}}catch(t){console.warn("[OQtima] Error detecting page language:",t)}t.forEach(t=>{const o=t.getAttribute("data-lang")||e;t.hasAttribute("data-lang")||t.setAttribute("data-lang",o);let r=t.getAttribute("data-referral-type");const a=t.getAttribute("data-referral-value");if(r){const t=parseInt(r,10);isNaN(t)?console.warn("[OQtima] data-referral-type is not a valid integer:",r):r=t}const i=t.tagName.toLowerCase();if(t.hasAttribute("data-lang")||(console.warn("[OQtima] Missing required data-lang attribute on trigger element:",t),"development"===n&&(t.style.border="1px dotted #ff4400",t.title="Missing required data-lang attribute for Oqtima registration popup")),"button"!==i&&"a"!==i&&(t.style.cursor="pointer",!t.classList.contains("oqtima-styled"))){window.getComputedStyle(t).backgroundColor;t.addEventListener("mouseenter",function(){t.classList.contains("oqtima-styled")||(t.style.opacity="0.9")}),t.addEventListener("mouseleave",function(){t.classList.contains("oqtima-styled")||(t.style.opacity="1")})}t.addEventListener("click",function(t){if(t.preventDefault(),t.stopPropagation(),window.sessionStorage)try{sessionStorage.setItem("oqtima_popup_mode","true");const t=12===r||14===r;t?r&&t&&(sessionStorage.setItem("oqtima_referral_type",r),a?sessionStorage.setItem("oqtima_referral_value",a):null!==sessionStorage.getItem("oqtima_referral_value")&&sessionStorage.removeItem("oqtima_referral_value")):(null!==sessionStorage.getItem("oqtima_referral_type")&&sessionStorage.removeItem("oqtima_referral_type"),null!==sessionStorage.getItem("oqtima_referral_value")&&sessionStorage.removeItem("oqtima_referral_value"))}catch(t){console.warn("[OQtima] Error storing parameters in sessionStorage:",t)}const e=12===r||14===r;window.__OQTIMA_REFERRAL_TYPE__=r,e&&a?window.__OQTIMA_REFERRAL_VALUE__=a:void 0!==window.__OQTIMA_REFERRAL_VALUE__&&delete window.__OQTIMA_REFERRAL_VALUE__;const n={lang:o,preserveParentDirection:!0};null!=r&&""!==r&&(n.referral_type=r),null!=a&&""!==a&&(n.referral_value=a),l(n)})})}();const t=document.querySelectorAll("[data-oqtima-register]");t.length>0&&(console.warn("[OQtima] Using legacy registration container approach.\nThis approach is deprecated. Please use data-oqtima-trigger attribute on buttons, links, or any clickable elements instead.\nExample: <a href='#' data-oqtima-trigger data-lang='en' data-referral-type='14' data-referral-value='YOUR_CAMPAIGN_ID'>Register Now</a>"),d(t));document.addEventListener("click",function(t){if(t.oqtimaProcessed||t.target.hasAttribute&&t.target.hasAttribute("data-oqtima-trigger"))return;t.oqtimaProcessed=!0;let e=t.target;if("A"!==e.tagName&&"BUTTON"!==e.tagName&&(e=t.target.closest("a, button")),!e)return;const n=t=>{const n={lang:"en",referral_type:null,referral_value:null};try{if(t.hasAttribute("data-lang")?n.lang=t.getAttribute("data-lang"):t.hasAttribute("lang")&&(n.lang=t.getAttribute("lang")),t.hasAttribute("data-referral-type")&&(n.referral_type=t.getAttribute("data-referral-type")),t.hasAttribute("data-referral-value")&&(n.referral_value=t.getAttribute("data-referral-value")),"A"===t.tagName&&t.href){const e=new URL(t.href,window.location.href);if(e.pathname.includes("register")||e.pathname.includes("signup")||e.pathname.includes("registration")||e.pathname.includes("account")||e.search&&(e.search.includes("register")||e.search.includes("signup")||e.search.includes("registration")||e.search.includes("account"))){const t=e.pathname.match(/\/(en|fr|br|vn|th|es|it|cn|zh|id|jp|my|ar)\//);t&&t[1]&&(n.lang=t[1]);const o=e.searchParams,r=["referral_type","referralType","referral-type","refType","ref_type"];for(const t of r)if(o.has(t)){n.referral_type=o.get(t);break}const a=["referral_value","referralValue","referral-value","refValue","ref_value"];for(const t of a)if(o.has(t)){n.referral_value=o.get(t);break}(o.has("campaign")||o.has("campaign_id"))&&(n.referral_type=14,n.referral_value=o.get("campaign")||o.get("campaign_id")),(o.has("ib")||o.has("ib_id"))&&(n.referral_type=12,n.referral_value=o.get("ib")||o.get("ib_id"))}}if(e.textContent){const t=e.textContent.toLowerCase().trim();if(["register","registration","sign up","signup","create account","join","open account","free account","start trading","trade now"].some(e=>t.includes(e)))return n}const o=e.className?e.className.toLowerCase():"",r=e.id?e.id.toLowerCase():"",a=["register","registration","signup","sign-up","account","create","join","cta"];return a.some(t=>o.includes(t))||a.some(t=>r.includes(t))?n:null}catch(t){return console.error("[OQtima] Error extracting referral parameters:",t),null}},o=n(e);if(!o)return;t.preventDefault(),t.stopPropagation();const r={lang:o.lang||"en",preserveParentDirection:!0};if(o.referral_type){const t=parseInt(o.referral_type,10);r.referral_type=isNaN(t)?o.referral_type:t}if(o.referral_value&&(r.referral_value=o.referral_value),window.sessionStorage)try{sessionStorage.setItem("oqtima_popup_mode","true"),o.referral_type&&sessionStorage.setItem("oqtima_referral_type",o.referral_type),o.referral_value&&sessionStorage.setItem("oqtima_referral_value",o.referral_value)}catch(t){console.warn("[OQtima] Error storing parameters in sessionStorage:",t)}window.__OQTIMA_REFERRAL_TYPE__=r.referral_type,window.__OQTIMA_REFERRAL_VALUE__=r.referral_value,l(r)})}()):i("Invalid API key. Registration button will not be displayed.")}catch(t){console.error("[OQtima] Verification process error:",t),i(`Error during API key verification: ${t.message}`)}}catch(t){console.error("[OQtima] Initialization error:",t.message),i("Registration initialization error: "+t.message)}}function i(t){console.warn("[OQtima] Authentication error:",t);if(document.querySelectorAll("[data-oqtima-register]").forEach(e=>{"development"===n?e.innerHTML=`\n          <div style="\n            padding: 10px; \n            border: 1px solid #ff4400; \n          border-radius: 4px;\n            color: #ff4400; \n            font-family: monospace; \n            font-size: 12px;\n            background-color: rgba(255, 68, 0, 0.1);\n            text-align: left;\n          ">\n            <strong>OQtima Registration Error:</strong><br>\n            ${t}<br>\n          <small>(This error is only visible in development mode)</small>\n          </div>\n        `:e.style.display="none"}),"development"===n){document.querySelectorAll("[data-oqtima-trigger]").forEach(e=>{e.style.border="1px solid #ff4400",e.title=`OQtima Registration Error: ${t}`;const n=e.cloneNode(!0);e.parentNode.replaceChild(n,e),n.addEventListener("click",function(e){e.preventDefault(),alert(`OQtima Registration Error: ${t}\n\nAPI key validation failed. Please check your implementation.`)})})}}function l(t={}){_()&&(p(),function(){if("undefined"==typeof window||"undefined"==typeof document)return;_()&&!r.originalHtmlDir&&p();if(!_())return;const t=Element.prototype.setAttribute,e=Element.prototype.removeAttribute,n=(DOMTokenList.prototype.add,DOMTokenList.prototype.remove);Element.prototype.setAttribute=function(e,n){if(this===document.documentElement||this===document.body){if("dir"===e&&"rtl"!==n&&"rtl"===r.originalHtmlDir)return t.call(this,e,"rtl");if("data-rtl"===e&&"true"!==n&&"true"===r.originalHtmlRtl)return t.call(this,e,"true")}return t.call(this,e,n)},Element.prototype.removeAttribute=function(t){if(this!==document.documentElement&&this!==document.body||"dir"!==t&&"data-rtl"!==t||"rtl"!==r.originalHtmlDir)return e.call(this,t)},DOMTokenList.prototype.remove=function(...t){if(this===document.documentElement.classList||this===document.body.classList){const e=t.filter(t=>"rtl"===t||"rtl-active"===t),o=t.filter(t=>"rtl"!==t&&"rtl-active"!==t);if(e.length>0&&"rtl"===r.originalHtmlDir)return o.length>0?n.apply(this,o):void 0}return n.apply(this,t)},window.__OQTIMA_UNPROTECT_RTL_ATTRIBUTES__=function(){Element.prototype.setAttribute=t,Element.prototype.removeAttribute=e,DOMTokenList.prototype.remove=n}}());const e={...t};let n=null;try{if("undefined"!=typeof window&&window.location.pathname){const t=window.location.pathname.split("/").filter(Boolean);if(t.length>0&&/^[a-z]{2}(-[a-z]{2})?$/.test(t[0])){n=t[0].toLowerCase();try{sessionStorage.setItem("oqtima_tab_language",n),sessionStorage.setItem("oqtima_detected_lang_source","url_path"),sessionStorage.setItem("oqtima_url_path_lang",n),sessionStorage.setItem("LANG_LOCKED","true"),sessionStorage.setItem("LOCK_SOURCE","URL"),window.__OQTIMA_URL_PATH_LANG=n,window.__OQTIMA_LANG_PRIORITY="url_path",window.__OQTIMA_LANG_LOCKED=!0,window.__OQTIMA_LOCKED_LANG=n,window.__FORCE_LANGUAGE=n,document.documentElement.dataset.enforcedLang=n,document.cookie=`i18next=${n};path=/;max-age=3600`;try{localStorage.setItem("i18nextLng",n),localStorage.setItem("gatsby-i18next-language",n)}catch(t){}}catch(t){console.warn("[OQtima] Error storing URL path language:",t)}}}}catch(t){console.warn("[OQtima] Error checking URL path for language:",t)}n?(e.language=n,e.lang=n,e["data-lang"]=n,e.langParam=n):e.language=e.language||e.lang||e["data-lang"]||e.langParam||"en";const o=e["data-lang"];window.__OQTIMA_LANG_MUST_USE=e.language,sessionStorage.setItem("oqtima_enforced_language",e.language),sessionStorage.setItem("oqtima_final_language",e.language);const a=(e.language||"").toLowerCase().trim();if(e.isRTL="ar"===a||a.startsWith("ar-")||"arabic"===a||o&&"ar"===o.toLowerCase(),"undefined"!=typeof window)try{sessionStorage.setItem("oqtima_popup_rtl",e.isRTL?"true":"false"),window.__OQTIMA_POPUP_RTL__=e.isRTL,window.__OQTIMA_POPUP_LANGUAGE__=e.language}catch(t){console.warn("[OQtima] Error storing RTL state:",t)}const i=["referral_type","referralType","referral-type","refType","ref_type","ref-type","affiliate_type","affType"],l=["referral_value","referralValue","referral-value","refValue","ref_value","ref-value","affiliate_value","affValue"];for(const t of i)if(e[t]&&!e.referral_type){e.referral_type=e[t];break}for(const t of l)if(e[t]&&!e.referral_value){e.referral_value=e[t];break}let d=!1;for(const t of i)if(e[t]){d=!0;break}try{if(d&&(!e.referral_type||!e.referral_value)&&"undefined"!=typeof window){const t=new URLSearchParams(window.location.search);if(!e.referral_type)for(const n of i){const o=t.get(n);if(o){e.referral_type=o;break}}if(!e.referral_value)for(const n of l){const o=t.get(n);if(o){e.referral_value=o;break}}}}catch(t){console.warn("[OQtima] Error extracting referral parameters from URL:",t)}if(e.referral_type){const t=parseInt(e.referral_type,10);isNaN(t)?(console.warn("[OQtima] referral_type is not a valid integer:",e.referral_type),d||delete e.referral_type):e.referral_type=t}const g=Date.now().toString(36)+Math.random().toString(36).substr(2),f=document.documentElement.getAttribute("dir"),w=document.documentElement.getAttribute("lang")||"en",y=(document.body.getAttribute("dir"),document.body.className),h=document.documentElement.className,b=document.body.getAttribute("style")||"",E=document.documentElement.getAttribute("style")||"",A=document.body.style.overflow,L=document.documentElement.style.overflow,v=window.scrollY;if("undefined"!=typeof window&&!e.embedded){window.innerWidth<=767||!0===e.forceMobile||!0===e.isMobile||!0===e.mobile?(window.__OQTIMA_MOBILE_ORIGINAL_TOUCH_ACTION=document.body.style.touchAction||"",window.__OQTIMA_MOBILE_ORIGINAL_WEBKIT_OVERFLOW=document.body.style.webkitOverflowScrolling||"",document.body.style.overflow="hidden",document.body.style.touchAction="none",document.body.style.webkitOverflowScrolling="auto",window.__OQTIMA_MOBILE_SCROLL_X=window.scrollX||window.pageXOffset||0,window.__OQTIMA_MOBILE_SCROLL_Y=window.scrollY||window.pageYOffset||0):(document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.width="100%",document.body.style.top=`-${v}px`)}if("undefined"!=typeof window){try{sessionStorage.setItem("oqtima_tab_language",e.language),sessionStorage.setItem("oqtima_tab_rtl",e.isRTL?"true":"false"),sessionStorage.setItem("oqtima_tab_session",g),sessionStorage.setItem("oqtima_popup_mode","true"),sessionStorage.setItem("oqtima_parent_dir",f),sessionStorage.setItem("oqtima_parent_lang",w),o&&sessionStorage.setItem("oqtima_data_lang",o),e.isRTL&&sessionStorage.setItem("oqtima_force_rtl","true");const t=12===e.referral_type||14===e.referral_type;t?null!=e.referral_type&&t&&(sessionStorage.setItem("oqtima_referral_type",e.referral_type),e.referral_value?sessionStorage.setItem("oqtima_referral_value",e.referral_value):null!==sessionStorage.getItem("oqtima_referral_value")&&sessionStorage.removeItem("oqtima_referral_value")):(null!==sessionStorage.getItem("oqtima_referral_type")&&sessionStorage.removeItem("oqtima_referral_type"),null!==sessionStorage.getItem("oqtima_referral_value")&&sessionStorage.removeItem("oqtima_referral_value"));("br"===e.language||"pt-br"===e.language||"pt_br"===e.language)&&sessionStorage.setItem("oqtima_is_brazilian_portuguese","true")}catch(t){console.warn("[OQtima] Could not set sessionStorage:",t)}if(window.__OQTIMA_COMPONENT_LANGUAGE=e.language,window.__OQTIMA_LOCKED_LANG=e.language,window.__OQTIMA_FORCE_RTL__=e.isRTL,window.__ORIGINAL_RTL__=e.isRTL,window.__OQTIMA_TAB_SESSION__=g,window.__OQTIMA_POPUP_MODE__=!0,window.__OQTIMA_PARENT_DIR__=f,window.__OQTIMA_DATA_LANG__=o,null!=e.referral_type){window.__OQTIMA_REFERRAL_TYPE__=e.referral_type;(12===e.referral_type||14===e.referral_type)&&e.referral_value?window.__OQTIMA_REFERRAL_VALUE__=e.referral_value:void 0!==window.__OQTIMA_REFERRAL_VALUE__&&delete window.__OQTIMA_REFERRAL_VALUE__}else void 0!==window.__OQTIMA_REFERRAL_TYPE__&&delete window.__OQTIMA_REFERRAL_TYPE__,void 0!==window.__OQTIMA_REFERRAL_VALUE__&&delete window.__OQTIMA_REFERRAL_VALUE__}const O=e.ip_address||null,T=e.country_name||null,I=e.country_code||null;let S=null,R=null;if(void 0!==e.referral_type&&null!==e.referral_type&&""!==e.referral_type){S=e.referral_type;const t=12===S||14===S;void 0!==e.referral_value&&null!==e.referral_value&&""!==e.referral_value?R=e.referral_value:t&&(R=null)}else S=null,R=null;const x="undefined"!=typeof window&&(window.innerWidth<=767||!0===e.forceMobile||!0===e.isMobile||!0===e.mobile);try{x?function(t,e,n,o,r,a,i,l,s,m){let d=t;try{const t=window.location.pathname.split("/").filter(Boolean);if(t.length>0&&/^[a-z]{2}(-[a-z]{2})?$/.test(t[0])){const e=t[0].toLowerCase();e&&"en"!==e&&(d=e)}}catch(t){}const p={gatsbyLang:"undefined"!=typeof window?window.gatsby_i18next_language:null,localStorage_i18nextLng:null,localStorage_gatsbyLang:null,sessionStorage_oqtimaTabLang:null};try{"undefined"!=typeof localStorage&&(p.localStorage_i18nextLng=localStorage.getItem("i18nextLng"),p.localStorage_gatsbyLang=localStorage.getItem("gatsby-i18next-language")),"undefined"!=typeof sessionStorage&&(p.sessionStorage_oqtimaTabLang=sessionStorage.getItem("oqtima_tab_language"))}catch(t){}const u=`oqtima_popup_lang_${Date.now()}`,_=`oqtima_popup_isolated_${Date.now()}`;try{sessionStorage.setItem(u,d),sessionStorage.setItem(_,"true"),window.__POPUP_FINAL_LANGUAGE=d,window.__POPUP_ISOLATED=!0}catch(t){}const g=RTL_LANGUAGES.includes(d),f=document.createElement("div");f.className="popup-registration__mobile-container",f.style.position="fixed",f.style.top="0",f.style.left="0",f.style.width="100%",f.style.height="100%",f.style.backgroundColor="rgba(0, 0, 0, 0.5)",f.style.zIndex="999999",f.style.display="flex",f.style.justifyContent="center",f.style.alignItems="center",g?(f.setAttribute("dir","rtl"),f.setAttribute("lang",d)):f.setAttribute("lang",d);const w=document.createElement("iframe");w.className="popup-registration__mobile-fullscreen",w.style.position="fixed",w.style.bottom="0",w.style.left="0",w.style.width="100%",w.style.height="100%",w.style.border="none",w.style.backgroundColor="#ffffff",w.style.zIndex="1000000",w.style.overflow="hidden",w.style.transition="all 0.3s ease-in-out",w.setAttribute("lang",d),g&&w.setAttribute("dir","rtl");let y;try{y=c(d,e,n,!0);const t=new URL(y),o=new URLSearchParams(t.search);if(o.set("language",d),o.set("lang",d),o.set("langParam",d),o.set("data-lang",d),o.set("i18nextLng",d),o.set("gatsby-i18next-language",d),o.set("forceLang","true"),o.set("forceLanguage","true"),o.set("mobile","true"),o.set("isMobile","true"),o.set("popup_isolated","true"),o.set("prevent_lang_switch","true"),o.set("_t",Date.now().toString()),o.set("_mobile","1"),o.set("_isolated","1"),null!=e&&""!==e&&!isNaN(parseInt(e,10))){const t=parseInt(e,10);o.set("referral_type",t.toString()),o.set("referralType",t.toString())}if(null!=n&&""!==n&&!isNaN(parseInt(n,10))){const t=parseInt(n,10);o.set("referral_value",t.toString()),o.set("referralValue",t.toString())}t.search=o.toString(),t.hash=`lang=${d}&isolated=true`,y=t.toString()}catch(t){console.error("[Mobile Fix] Error enhancing iframe URL:",t),y=c(d,e,n,!0)}w.src=y,f.appendChild(w),document.body.appendChild(f);const h=document.createElement("style");h.textContent=`\n      .popup-registration__mobile-container {\n        font-family: Arial, sans-serif;\n      }\n      \n      .popup-registration__mobile-fullscreen {\n        -webkit-overflow-scrolling: touch;\n      }\n      \n      ${g?'\n      .popup-registration__mobile-container[dir="rtl"] {\n        direction: rtl;\n        text-align: right;\n      }\n      \n      .popup-registration__mobile-fullscreen[dir="rtl"] {\n        direction: rtl;\n      }\n      ':""}\n    `,document.head.appendChild(h);let b=!1;function E(){try{window.__POPUP_ISOLATED=!1,b=!1;try{null!==p.localStorage_i18nextLng&&localStorage.setItem("i18nextLng",p.localStorage_i18nextLng),null!==p.localStorage_gatsbyLang&&localStorage.setItem("gatsby-i18next-language",p.localStorage_gatsbyLang),null!==p.sessionStorage_oqtimaTabLang&&sessionStorage.setItem("oqtima_tab_language",p.sessionStorage_oqtimaTabLang),null!==p.gatsbyLang&&(window.gatsby_i18next_language=p.gatsbyLang)}catch(t){}sessionStorage.removeItem(u),sessionStorage.removeItem(_),f&&f.parentNode&&f.parentNode.removeChild(f),h&&h.parentNode&&h.parentNode.removeChild(h),document.body.className=o||"",document.documentElement.className=r||"";const t=document.body.style,e=document.documentElement.style;a?document.body.setAttribute("style",a):document.body.removeAttribute("style"),i?document.documentElement.setAttribute("style",i):document.documentElement.removeAttribute("style"),t.overflow=l||"",e.overflow=s||"",t.position="",t.height="",t.maxHeight="",t.touchAction="",t.webkitOverflowScrolling="",t.overflowScrolling="",e.position="",e.height="",e.maxHeight="",e.touchAction="",e.webkitOverflowScrolling="",e.overflowScrolling="",window.innerWidth<=767&&(t.overflow=l||"auto",e.overflow=s||"auto",t.touchAction=window.__OQTIMA_MOBILE_ORIGINAL_TOUCH_ACTION||"auto",t.webkitOverflowScrolling=window.__OQTIMA_MOBILE_ORIGINAL_WEBKIT_OVERFLOW||"touch",t.position=a?.includes("position")&&a.match(/position:\s*([^;]+)/)?.[1]||"",e.position=i?.includes("position")&&i.match(/position:\s*([^;]+)/)?.[1]||"",t.height=a?.includes("height")&&a.match(/height:\s*([^;]+)/)?.[1]||"",e.height=i?.includes("height")&&i.match(/height:\s*([^;]+)/)?.[1]||"",t.top="",t.width=a?.includes("width")&&a.match(/width:\s*([^;]+)/)?.[1]||"",delete window.__OQTIMA_MOBILE_ORIGINAL_TOUCH_ACTION,delete window.__OQTIMA_MOBILE_ORIGINAL_WEBKIT_OVERFLOW),setTimeout(()=>{const t=window.__OQTIMA_MOBILE_SCROLL_X||0,e=window.__OQTIMA_MOBILE_SCROLL_Y||m||0;window.scrollTo(t,e),window.innerWidth<=767&&(document.body.scrollTop=e,document.documentElement.scrollTop=e,document.body.offsetHeight,document.documentElement.offsetHeight,setTimeout(()=>{window.scrollTo(t,e),delete window.__OQTIMA_MOBILE_SCROLL_X,delete window.__OQTIMA_MOBILE_SCROLL_Y},50))},10)}catch(t){if(console.error("[Mobile] Error in cleanup:",t),window.innerWidth<=767)try{document.body.style.overflow="auto",document.documentElement.style.overflow="auto",document.body.style.touchAction=window.__OQTIMA_MOBILE_ORIGINAL_TOUCH_ACTION||"auto",document.body.style.webkitOverflowScrolling=window.__OQTIMA_MOBILE_ORIGINAL_WEBKIT_OVERFLOW||"touch",document.body.style.position="",document.documentElement.style.position="",document.body.style.height="",document.documentElement.style.height="",document.body.style.top="",document.body.style.width="";const t=window.__OQTIMA_MOBILE_SCROLL_X||0,e=window.__OQTIMA_MOBILE_SCROLL_Y||m||0;setTimeout(()=>{window.scrollTo(t,e),delete window.__OQTIMA_MOBILE_SCROLL_X,delete window.__OQTIMA_MOBILE_SCROLL_Y,delete window.__OQTIMA_MOBILE_ORIGINAL_TOUCH_ACTION,delete window.__OQTIMA_MOBILE_ORIGINAL_WEBKIT_OVERFLOW},100)}catch(t){console.error("[Mobile] Emergency scroll fix failed:",t)}}}(()=>{if(b)return;b=!0;const t=Storage.prototype.setItem;if(Storage.prototype.setItem=function(e,n){return!window.__POPUP_ISOLATED||"i18nextLng"!==e&&"gatsby-i18next-language"!==e&&"oqtima_tab_language"!==e||n===d?t.call(this,e,n):(console.warn(`[Popup Protection] Prevented parent window from changing ${e} from ${d} to ${n}`),t.call(this,e,d))},void 0!==window.gatsby_i18next_language){let t=d;Object.defineProperty(window,"gatsby_i18next_language",{get:function(){return t},set:function(e){window.__POPUP_ISOLATED&&e!==d?console.warn(`[Popup Protection] Prevented gatsby_i18next_language change from ${d} to ${e}`):t=e},configurable:!0})}})();const A=()=>{try{const t={type:"REGISTRATION_PARAMS",data:{language:d,isRTL:g,isMobile:!0,mobileView:!0,mobileScroll:!0,referral_type:e,referralType:e,"referral-type":e,referral_value:n,referralValue:n,"referral-value":n,isolated:!0,popupMode:!0,parentLang:d,parentDir:g?"rtl":"ltr",timestamp:Date.now()}};try{e&&(sessionStorage.setItem("oqtima_referral_type",e),window.__OQTIMA_REFERRAL_TYPE__=e),n&&(sessionStorage.setItem("oqtima_referral_value",n),window.__OQTIMA_REFERRAL_VALUE__=n)}catch(t){console.warn("[Mobile] Error storing parameters in sessionStorage:",t)}const o=()=>{try{w.contentWindow.postMessage(t,"*")}catch(t){console.warn("[Mobile] Error sending message to iframe:",t)}};o(),setTimeout(o,100),setTimeout(o,500),setTimeout(o,1e3)}catch(t){console.error("[Mobile] Error in sendParamsToIframe:",t)}};w.addEventListener("load",function(){A()});const L=function(t){try{if(t.data&&"object"==typeof t.data){if("OQTIMA_CLOSE_POPUP"===t.data.type||"CLOSE_POPUP"===t.data.type||"close"===t.data.action)return void(window.__OQTIMA_CLOSE_POPUP?window.__OQTIMA_CLOSE_POPUP():(E(),window.removeEventListener("message",L),document.removeEventListener("keydown",keyDownHandler)));"IFRAME_READY"===t.data.type&&A(),"LANGUAGE_CHANGED"===t.data.type&&t.data.language!==d&&A()}if("close_popup"===t.data)return void(window.__OQTIMA_CLOSE_POPUP?window.__OQTIMA_CLOSE_POPUP():(E(),window.removeEventListener("message",L),document.removeEventListener("keydown",keyDownHandler)))}catch(t){}};window.addEventListener("message",L),setTimeout(()=>{window.__OQTIMA_CLOSE_POPUP?window.__OQTIMA_CLOSE_POPUP():(E(),window.removeEventListener("message",L),document.removeEventListener("keydown",keyDownHandler))},18e5);try{sessionStorage.setItem("oqtima_parent_lang",d),sessionStorage.setItem("oqtima_parent_dir",g?"rtl":"ltr"),sessionStorage.setItem("oqtima_popup_isolated","true");["i18nextLng","gatsby-i18next-language","oqtima_tab_language","oqtima_enforced_language","oqtima_final_language","oqtima_selected_language","lang","language","locale"].forEach(t=>{try{sessionStorage.setItem(t,d),localStorage.setItem(t,d)}catch(t){}})}catch(t){console.warn("[Mobile Popup] Error setting language overrides:",t)}}(e.language,S,R,y,h,b,E,A,L,v):e.isRTL?function(t,e,n,o,a,i,l,m,d,p,g,f,w){const y=document.createElement("div");y.id="oqtima-registration-modal",y.className="popup-registration popup-registration--rtl popup-registration--active",y.setAttribute("dir","rtl"),y.setAttribute("lang",t),y.style.cssText="\n      position: fixed !important;\n      top: 0 !important;\n      left: 0 !important;\n      width: 100% !important;\n      height: 100% !important;\n      z-index: 2147483647 !important;\n      display: flex !important;\n      justify-content: center !important;\n      align-items: center !important;\n        background-color: rgba(0, 0, 0, 0.7) !important;\n      overflow-y: auto !important;\n        direction: rtl !important;\n    ";const h=document.createElement("style");h.id="oqtima-rtl-styles",h.textContent="\n      /* Isolated RTL styles - only apply to popup elements */\n      #oqtima-registration-modal {\n        direction: rtl !important;\n      }\n      #oqtima-registration-modal.popup-registration--rtl {\n        direction: rtl !important;\n      }\n      #oqtima-registration-modal.popup-registration--rtl .popup-registration__container {\n        flex-direction: row-reverse !important;\n      }\n      #oqtima-registration-modal.popup-registration--rtl .popup-registration__sidebar--rtl {\n        order: 2 !important;\n      }\n      #oqtima-registration-modal.popup-registration--rtl .popup-registration__content--rtl {\n        order: 1 !important;\n      }\n      #oqtima-registration-modal.popup-registration--rtl * {\n        direction: rtl !important;\n        text-align: right !important;\n      }\n      #oqtima-registration-modal.popup-registration--rtl input,\n      #oqtima-registration-modal.popup-registration--rtl select,\n      #oqtima-registration-modal.popup-registration--rtl textarea {\n        text-align: right !important;\n        direction: rtl !important;\n      }\n    ",document.head.appendChild(h);const b=window.innerWidth>=768&&window.innerWidth<1024,E=document.createElement("div");E.className="popup-registration__wrapper popup-registration__wrapper--rtl",E.setAttribute("dir","rtl"),E.style.cssText=`\n      width: 100% !important;\n      max-width: 1170px !important;\n      height: 100% !important;\n      max-height: ${b?"900px":"800px"} !important;\n      display: flex !important;\n      justify-content: center !important;\n      align-items: center !important;\n      // overflow-y: auto !important;\n      direction: rtl !important;\n    `;const A=document.createElement("div");A.className="popup-registration__container popup-registration__container--rtl",A.setAttribute("dir","rtl"),A.style.cssText="\n      display: flex !important;\n      flex-direction: row-reverse !important;\n          border-radius: 10px !important;\n      overflow: hidden !important;\n      width: 100% !important;\n      max-height: 100% !important;\n      // height: 900px !important;\n          direction: rtl !important;\n        ";const L=document.createElement("div");L.className="popup-registration__iframe-container popup-registration__iframe-container--rtl",L.style.cssText=`\n      position: relative !important;\n      background-color: transparent !important;\n      border-radius: 10px !important;\n      overflow: hidden !important;\n      flex: 1 !important;\n      min-height: 600px !important;\n      height: ${b?"900px":"800px"} !important;\n      z-index: 2147483647 !important;\n      direction: rtl !important;\n      order: 1 !important;\n    `;const v=document.createElement("div");v.id="oqtima-spinner",v.style.cssText="\n          position: absolute !important;\n          top: 50% !important;\n          left: 50% !important;\n          transform: translate(-50%, -50%) !important;\n      width: 40px !important;\n      height: 40px !important;\n      z-index: 999999 !important;\n      opacity: 1 !important;\n      visibility: visible !important;\n      display: block !important;\n      background: transparent !important;\n    ";const O=document.createElement("style");O.id="oqtima-spinner-styles",O.innerHTML='\n      #oqtima-spinner:after {\n        content: "" !important;\n        display: block !important;\n        width: 40px !important;\n        height: 40px !important;\n        border-radius: 50% !important;\n        border: 3px solid #ff4400 !important;\n        border-color: #ff4400 transparent #ff4400 transparent !important;\n        animation: oqtima-spinner 1.2s linear infinite !important;\n      }\n      @keyframes oqtima-spinner {\n        0% { transform: rotate(0deg); }\n        100% { transform: rotate(360deg); }\n      }\n    ',document.head.appendChild(O);const T=document.createElement("iframe");T.id="oqtima-registration-iframe",T.setAttribute("dir","rtl"),T.setAttribute("lang",t),T.setAttribute("allow","clipboard-write"),T.setAttribute("allowfullscreen","true"),T.setAttribute("allowtransparency","true"),T.setAttribute("scrolling","yes"),T.setAttribute("importance","high"),T.setAttribute("title","Registration Form RTL"),T.setAttribute("crossorigin","anonymous"),T.style.cssText="\n          width: 100% !important;\n          height: 100% !important;\n          border: none !important;\n          background-color: #ffffff !important;\n          box-shadow: 0 0 40px rgba(0, 0, 0, 0.7) !important;\n          transition: all 0.3s ease-in-out !important;\n          display: block !important;\n      opacity: 0 !important;\n          transition: opacity 0.3s ease-in-out !important;\n      overflow-y: scroll !important;\n      overflow-x: hidden !important;\n      -webkit-overflow-scrolling: touch !important;\n      transform: translateZ(0) !important;\n      -webkit-transform: translateZ(0) !important;\n      -webkit-backface-visibility: hidden !important;\n      direction: rtl !important;\n    ";const I=c(t,e,n,!1);T.src=I,T.addEventListener("load",function(){v&&v.parentNode&&v.parentNode.removeChild(v),O&&O.parentNode&&O.parentNode.removeChild(O),T.style.opacity="1";try{const o={type:"REGISTRATION_PARAMS",data:{referral_type:e,referral_value:n,language:t,lang:t,data_lang:t,ip_address:g,country_name:f,country_code:w},timestamp:Date.now()};T.contentWindow.postMessage(o,"*"),setTimeout(()=>{try{T.contentWindow.postMessage(o,"*")}catch(t){console.error("Error in RTL retry 1:",t)}},100),setTimeout(()=>{try{T.contentWindow.postMessage(o,"*")}catch(t){console.error("Error in RTL retry 2:",t)}},500),setTimeout(()=>{try{T.contentWindow.postMessage(o,"*")}catch(t){console.error("Error in RTL final retry:",t)}},1500)}catch(t){console.error("Error sending message to RTL iframe:",t)}try{const t=T.contentDocument||T.contentWindow.document;if(t&&t.body){const e=document.createElement("meta");e.name="viewport",e.content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover",t.head.appendChild(e);const n=document.createElement("meta");n.name="oqtima-direction",n.content="rtl",t.head.appendChild(n);const o=document.createElement("style");o.textContent="\n            html, body {\n              direction: rtl !important;\n              text-align: right !important;\n            }\n            * {\n              direction: inherit !important;\n            }\n            input, select, textarea {\n              text-align: right !important;\n            }\n          ",t.head.appendChild(o)}}catch(t){console.error("Error setting up RTL iframe:",t)}}),L.appendChild(v),L.appendChild(T),A.appendChild(L),E.appendChild(A),y.appendChild(E),document.body.appendChild(y),s(y,T,O,h,o,a,i,l,m,d),window.__OQTIMA_RTL_CLEANUP=function(){_()&&"rtl"===r.originalHtmlDir&&u()}}(e.language,S,R,y,h,b,E,A,L,0,O,T,I):function(t,e,n,o,r,a,i,l,d,p,u,_,g){const f=window.innerWidth<=767,w=document.createElement("div");w.className="oqtima-loading-overlay",w.style.cssText="\n      position: fixed !important;\n      top: 0 !important;\n      left: 0 !important;\n      right: 0 !important;\n      bottom: 0 !important;\n      background: rgba(0, 0, 0, 0.7) !important;\n      display: flex !important;\n      justify-content: center !important;\n      align-items: center !important;\n      z-index: 2147483647 !important;\n    ";const y=document.createElement("div");y.className="oqtima-loading-spinner",y.style.cssText="\n      width: 50px !important;\n      height: 50px !important;\n      border: 4px solid #f3f3f3 !important;\n      border-top: 4px solid #ff4400 !important;\n      border-radius: 50% !important;\n      animation: oqtima-spin 1s linear infinite !important;\n    ",w.appendChild(y);const h=y,b=document.createElement("style");b.textContent="\n      @keyframes oqtima-spin {\n        0% { transform: rotate(0deg); }\n        100% { transform: rotate(360deg); }\n      }\n\n      /* Mobile styles */\n      @media (max-width: 767px) {\n        .popup-registration {\n          position: fixed !important;\n          top: 0 !important;\n          left: 0 !important;\n          right: 0 !important;\n          bottom: 0 !important;\n          width: 100% !important;\n          height: 100% !important;\n          display: flex !important;\n          flex-direction: column !important;\n          background: rgba(0, 0, 0, 0.7) !important;\n        }\n\n        .popup-registration__wrapper {\n          flex: 1 !important;\n          width: 100% !important;\n          height: 100% !important;\n          display: flex !important;\n          flex-direction: column !important;\n          background: white !important;\n          position: relative !important;\n        }\n\n        .popup-registration__iframe {\n          flex: 1 !important;\n          height: 100% !important;\n          border: none !important;\n        }\n      }\n    ",document.head.appendChild(b),document.body.appendChild(w);const E=document.createElement("div");E.className="popup-registration";let A="\n      position: fixed !important;\n      top: 0 !important;\n      left: 0 !important;\n      width: 100% !important;\n      height: 100% !important;\n      z-index: 2147483646 !important;\n      display: flex !important;\n      background-color: rgba(0, 0, 0, 0.7) !important;\n      opacity: 0;\n      transition: opacity 0.3s ease-in-out;\n    ";A+=f?"\n        flex-direction: column !important;\n      ":"\n      justify-content: center !important;\n      align-items: center !important;\n    ";E.style.cssText=A;const L=document.createElement("div");L.className="popup-registration__wrapper";let v="\n      background: white !important;\n      transform: scale(0.98);\n      transition: transform 0.3s ease-in-out;\n    ";if(f)v+="\n        flex: 1 !important;\n      width: 100% !important;\n      height: 100% !important;\n      display: flex !important;\n        flex-direction: column !important;\n      ";else{v+=`\n      width: 100% !important;\n        max-width: 1170px !important;\n        height: 100% !important;\n        max-height: ${window.innerWidth>=768&&window.innerWidth<1024?"900px":"800px"} !important;\n        border-radius: 8px !important;\n        overflow: hidden !important;\n      `}L.style.cssText=v;const O=document.createElement("iframe");O.className="popup-registration__iframe",O.setAttribute("allow","clipboard-write"),O.setAttribute("allowfullscreen","true"),O.setAttribute("allowtransparency","true"),O.setAttribute("scrolling","yes"),O.setAttribute("importance","high"),O.setAttribute("title","Registration Form"),O.setAttribute("crossorigin","anonymous");let T="\n      width: 100% !important;\n      border: none !important;\n      background: white !important;\n      opacity: 0;\n      transition: opacity 0.3s ease-in-out;\n    ";T+=f?"\n        flex: 1 !important;\n      height: 100% !important;\n      ":"\n        height: 100% !important;\n      ";O.style.cssText=T,O.setAttribute("scrolling","yes");let I=!1;const S=setTimeout(()=>{I||(console.warn("Iframe load timeout - forcing display"),R())},1e4);function R(){I||(I=!0,clearTimeout(S),w.style.opacity="0",setTimeout(()=>{if(w.remove(),E.style.opacity="1",L.style.transform="scale(1)",O.style.opacity="1",f)try{const t=O.contentDocument||O.contentWindow.document;if(t&&t.body){if(!t.querySelector('meta[name="viewport"]')){const e=t.createElement("meta");e.name="viewport",e.content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0",t.head.appendChild(e)}const e=t.createElement("style");e.textContent="\n                html {\n                  -webkit-text-size-adjust: 100%;\n                }\n                body {\n                  margin: 0;\n                  padding: 15px;\n                  min-height: 100vh;\n            }\n            form {\n                  padding-bottom: 50px;\n                }\n              ",t.head.appendChild(e)}}catch(t){console.warn("Could not apply iframe body styles:",t)}},300))}O.addEventListener("load",function(){h&&(h.style.display="none");try{const o={type:"REGISTRATION_PARAMS",data:{language:t,"data-lang":t,lang:t,data_lang:t,tab_language:t,oqtima_tab_language:t,i18nextLng:t,forceLang:"true",forceLanguage:"true",referral_type:e,referralType:e,"referral-type":e,referral_value:n,referralValue:n,"referral-value":n,ip_address:u,country_name:_,country_code:g,storeInSessionStorage:!0,storageKeys:[{key:"oqtima_referral_type",value:e},{key:"oqtima_referral_value",value:n},{key:"oqtima_tab_language",value:t},{key:"oqtima_tab_rtl",value:"ar"===t?"true":"false"},{key:"lang",value:t},{key:"language",value:t},{key:"i18nextLng",value:t}]},timestamp:Date.now()};O.contentWindow.postMessage(o,"*"),setTimeout(()=>{try{O.contentWindow.postMessage(o,"*")}catch(t){console.error("[OQtima] Error in retry 1:",t)}},100),setTimeout(()=>{try{O.contentWindow.postMessage(o,"*")}catch(t){console.error("[OQtima] Error in retry 2:",t)}},500),setTimeout(()=>{try{O.contentWindow.postMessage(o,"*")}catch(t){console.error("[OQtima] Error in final retry:",t)}},1500);try{setTimeout(()=>{try{const t=new URL(O.src).origin,e=window.location.origin;if(t===e){const t=O.contentDocument||O.contentWindow.document;if(t){const e=t.createElement("script");e.textContent='\n                    // Set up data receiver\n                    window.addEventListener("message", function(event) {\n                      if (event.data && event.data.type === "REGISTRATION_PARAMS") {\n                        // console.log("[OQtima][Iframe] Received parameters from parent");\n                        \n                        // Store data safely without accessing parent\n                        const params = event.data.data;\n                        \n                        // Store data in sessionStorage\n                        if (params.storeInSessionStorage && params.storageKeys) {\n                          params.storageKeys.forEach(item => {\n                            if (item.key && item.value !== undefined) {\n                              try {\n                                sessionStorage.setItem(item.key, item.value);\n                              } catch (e) {\n                                console.warn("[OQtima][Iframe] Failed to set storage item:", item.key);\n                              }\n                            }\n                          });\n                        }\n                        \n                        // Set global variables for language and referral\n                        if (params.language) window.__OQTIMA_LANGUAGE__ = params.language;\n                        if (params.referral_type) window.__OQTIMA_REFERRAL_TYPE__ = params.referral_type;\n                        if (params.referral_value) window.__OQTIMA_REFERRAL_VALUE__ = params.referral_value;\n                        \n                        // Send confirmation back to parent\n                        window.parent.postMessage({\n                          type: "REGISTRATION_PARAMS_RECEIVED",\n                          timestamp: Date.now()\n                        }, "*");\n                      }\n                    });\n                    \n                    // Send ready message to parent\n                    window.parent.postMessage({\n                      type: "IFRAME_READY",\n                      timestamp: Date.now()\n                    }, "*");\n              ',t.head.appendChild(e)}}}catch(t){}},200)}catch(t){console.warn("[OQtima] Could not inject script to iframe:",t)}}catch(t){console.error("Error sending message to iframe:",t)}O.addEventListener("load",m),setTimeout(R,500)});const x=c(t,e,n,f);if(O.src=x,null!=e&&n){let t=x;const o=x.split("?"),r=o[0],a=new URLSearchParams(o[1]||"");a.set("referral_type",e),a.set("referral_value",n),a.set("referralType",e),a.set("referralValue",n),a.set("referral-type",e),a.set("referral-value",n),t=`${r}?${a.toString()}`,O.src=t;t.length>150&&t.substring(0,147)}L.appendChild(O),E.appendChild(L),document.body.appendChild(E),f?document.body.style.cssText+="\n        position: fixed;\n        width: 100%;\n        overflow: hidden;\n      ":(document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden");s(E,O,b,o,r,a,i,l,d,p)}(e.language,S,R,y,h,b,E,A,L,v,O,T,I)}catch(t){console.error("[OQtima] Error creating popup:",t),document.body.className=y,document.documentElement.className=h,document.body.style.overflow=A,document.documentElement.style.overflow=L,b?document.body.setAttribute("style",b):document.body.removeAttribute("style"),E?document.documentElement.setAttribute("style",E):document.documentElement.removeAttribute("style"),window.scrollTo(0,v)}}function s(t,e,n,o,a,i,l,s,c,m){const d=document.documentElement.getAttribute("dir"),p=document.documentElement.getAttribute("lang"),g=document.body.getAttribute("dir"),f={classList:[...document.documentElement.classList],dataRtl:document.documentElement.getAttribute("data-rtl")},w={classList:[...document.body.classList],dataRtl:document.body.getAttribute("data-rtl")};window.__OQTIMA_CLOSE_POPUP=function(){try{try{sessionStorage.removeItem("oqtima_popup_rtl"),sessionStorage.removeItem("oqtima_popup_iframe_rtl"),sessionStorage.removeItem("oqtima_popup_mode"),delete window.__OQTIMA_POPUP_RTL__,delete window.__OQTIMA_POPUP_LANGUAGE__,delete window.__OQTIMA_POPUP_IFRAME_RTL__,delete window.__OQTIMA_POPUP_MODE__}catch(t){console.warn("[OQtima] Error cleaning up popup flags:",t)}window.__OQTIMA_UNPROTECT_RTL_ATTRIBUTES__&&(window.__OQTIMA_UNPROTECT_RTL_ATTRIBUTES__(),delete window.__OQTIMA_UNPROTECT_RTL_ATTRIBUTES__),window.__OQTIMA_RTL_CLEANUP&&(window.__OQTIMA_RTL_CLEANUP(),delete window.__OQTIMA_RTL_CLEANUP),t&&document.body.removeChild(t),n&&document.head.removeChild(n);const e=document.getElementById("oqtima-rtl-styles");e&&document.head.removeChild(e),window.__OQTIMA_MESSAGE_HANDLER&&(window.removeEventListener("message",window.__OQTIMA_MESSAGE_HANDLER),delete window.__OQTIMA_MESSAGE_HANDLER),window.__OQTIMA_ESC_HANDLER&&(document.removeEventListener("keydown",window.__OQTIMA_ESC_HANDLER),delete window.__OQTIMA_ESC_HANDLER),delete window.__OQTIMA_CLOSE_POPUP,_()&&"rtl"===r.originalHtmlDir?u():(d?document.documentElement.setAttribute("dir",d):document.documentElement.removeAttribute("dir"),p&&document.documentElement.setAttribute("lang",r.originalHtmlLang),g?document.body.setAttribute("dir",g):document.body.removeAttribute("dir"),document.documentElement.className=a,f.dataRtl?document.documentElement.setAttribute("data-rtl",f.dataRtl):document.documentElement.removeAttribute("data-rtl"),document.body.className=o,w.dataRtl?document.body.setAttribute("data-rtl",w.dataRtl):document.body.removeAttribute("data-rtl")),document.body.classList.remove("oqtima-iframe-open"),document.body.classList.remove("oqtima-mobile-open"),document.documentElement.classList.remove("oqtima-mobile-open"),document.body.classList.remove("oqtima-mobile-modal-open"),document.documentElement.classList.remove("oqtima-mobile-popup-open"),document.body.classList.remove("oqtima-mobile-popup-open"),document.body.style.position="",document.body.style.width="",document.body.style.top="",document.body.style.overflow=s||"",document.documentElement.style.overflow=c||"",m&&"object"==typeof m?window.scrollTo(m.x||0,m.y||0):"number"==typeof m&&window.scrollTo(0,m),i?document.body.setAttribute("style",i):document.body.removeAttribute("style"),l?document.documentElement.setAttribute("style",l):document.documentElement.removeAttribute("style")}catch(t){console.error("[OQtima] Error closing registration popup:",t);try{"function"==typeof window.__OQTIMA_EMERGENCY_RESTORE_SCROLL&&window.__OQTIMA_EMERGENCY_RESTORE_SCROLL()}catch(t){console.error("[OQtima] Emergency scroll restoration also failed:",t)}}},e.onload=function(){const t=document.getElementById("oqtima-modal-spinner");t&&(t.style.display="none")},window.__OQTIMA_MESSAGE_HANDLER=function(t){try{if("string"==typeof t.data&&t.data.startsWith("redirect:")){const e=t.data.substring(9);return void(e&&(window.__OQTIMA_REGISTRATION_REDIRECT_URL=e,window.__OQTIMA_CLOSE_POPUP&&window.__OQTIMA_CLOSE_POPUP(),setTimeout(function(){window.location.href=e},100)))}if(t.data&&"object"==typeof t.data&&"OQTIMA_CLOSE_POPUP"===t.data.type||t.data&&"object"==typeof t.data&&"CLOSE_POPUP"===t.data.type||t.data&&"object"==typeof t.data&&"close"===t.data.action||"close_popup"===t.data){if(window.__OQTIMA_CLOSE_POPUP){try{if(window.__OQTIMA_CLOSE_POPUP(),t.source&&"function"==typeof t.source.postMessage)try{t.source.postMessage({type:"OQTIMA_POPUP_CLOSED",success:!0,timestamp:Date.now()},"*")}catch(t){}}catch(t){try{const t=document.querySelector(".popup-registration");t&&t.parentNode&&t.parentNode.removeChild(t),document.body.style.overflow="",document.documentElement.style.overflow="",document.body.style.position="",document.body.style.width="",document.body.style.top="",document.body.classList.remove("oqtima-iframe-open","oqtima-mobile-open","popup-open"),document.documentElement.classList.remove("oqtima-mobile-open","oqtima-mobile-popup-open")}catch(t){}}return}try{const t=document.querySelector(".popup-registration");t&&t.parentNode&&t.parentNode.removeChild(t),document.body.style.overflow="",document.documentElement.style.overflow="",document.body.style.position="",document.body.style.width="",document.body.style.top="",document.body.classList.remove("oqtima-iframe-open","oqtima-mobile-open","popup-open"),document.documentElement.classList.remove("oqtima-mobile-open","oqtima-mobile-popup-open")}catch(t){}}if(t.origin&&!t.origin.includes("oqtima.com")&&!t.origin.includes("localhost")&&!t.origin.includes("127.0.0.1"))return;if(t.data&&"object"==typeof t.data&&!Array.isArray(t.data)){if("OQTIMA_REGISTRATION_SUCCESS"===t.data.type&&t.data.redirectUrl&&(window.__OQTIMA_REGISTRATION_REDIRECT_URL=t.data.redirectUrl,window.__OQTIMA_CLOSE_POPUP&&window.__OQTIMA_CLOSE_POPUP(),setTimeout(function(){t.data.redirectUrl&&"string"==typeof t.data.redirectUrl&&(window.location.href=t.data.redirectUrl)},t.data.redirectTimeout||100)),"OQTIMA_REDIRECT"===t.data.type){const e=t.data.url,n=t.data.timeout||0;e&&"string"==typeof e&&(window.__OQTIMA_CLOSE_POPUP&&window.__OQTIMA_CLOSE_POPUP(),setTimeout(function(){window.location.href=e},n))}if("OQTIMA_OPEN_LINK"===t.data.type)try{const e=t.data.url||"",n=!0===t.data.isPolicyLink,o=t.data.timestamp||Date.now();if(!e||"string"!=typeof e)return;if(n||/privacy|cookie|policy|terms|legal|disclaimer|gdpr|oqtima\.com/i.test(e)){let n=!1;(()=>{try{const t=window.open(e,"_blank");if(t&&!t.closed)try{return t.focus(),n=!0,!0}catch(t){console.warn("[OQtima] Error focusing policy window:",t)}else console.warn("[OQtima] window.open was blocked or returned null")}catch(t){console.warn("[OQtima] Error in window.open:",t)}return!1})()?t.source&&t.source.postMessage&&t.source.postMessage({type:"OQTIMA_LINK_OPENED",url:e,success:!0,timestamp:o,method:"window.open"},"*"):t.source&&t.source.postMessage&&t.source.postMessage({type:"OQTIMA_LINK_OPENED",url:e,success:!1,timestamp:o,method:"failed"},"*")}else console.warn("[OQtima] Non-policy link request was ignored for security reasons:",e),t.source&&t.source.postMessage&&t.source.postMessage({type:"OQTIMA_LINK_OPENED",url:e,success:!1,timestamp:o,method:"rejected",reason:"security"},"*")}catch(e){console.error("[OQtima] Error handling link open request:",e);try{t.source&&t.source.postMessage&&t.source.postMessage({type:"OQTIMA_LINK_OPENED",success:!1,error:e.message,timestamp:Date.now(),method:"error"},"*")}catch(t){console.error("[OQtima] Failed to notify iframe of error:",t)}}}if("string"==typeof t.data&&t.data.startsWith("redirect:")){const e=t.data.substring(9);e&&(window.__OQTIMA_CLOSE_POPUP&&window.__OQTIMA_CLOSE_POPUP(),setTimeout(function(){window.location.href=e},100))}}catch(t){console.error("[OQtima] Error in message handler:",t)}},window.__OQTIMA_ESC_HANDLER=function(t){"Escape"!==t.key&&27!==t.keyCode||window.__OQTIMA_CLOSE_POPUP()},window.addEventListener("message",window.__OQTIMA_MESSAGE_HANDLER),document.addEventListener("keydown",window.__OQTIMA_ESC_HANDLER)}function c(t,n,o,a){const i=window.__OQTIMA_URL_PATH_LANG||sessionStorage.getItem("oqtima_url_path_lang")||document.documentElement.dataset.enforcedLang,l=window.__OQTIMA_LANG_MUST_USE||sessionStorage.getItem("oqtima_final_language")||i;if(l&&t!==l){t=l;try{sessionStorage.setItem("oqtima_final_language",t),sessionStorage.setItem("i18nextLng",t),sessionStorage.setItem("lang",t)}catch(t){console.warn("[OQtima] Error reinforcing language:",t)}}i&&t!==i&&(t=i);if("ar"===t||"arabic"===(t||"").toLowerCase()){window.__FORCE_RTL__=!0,window.__ORIGINAL_RTL__=!0;try{if(sessionStorage.setItem("oqtima_tab_rtl","true"),sessionStorage.setItem("oqtima_tab_language","ar"),sessionStorage.setItem("isRTL","true"),!window.__RTL_PROTECTION_ACTIVE){window.__RTL_PROTECTION_ACTIVE=!0;const t=Storage.prototype.setItem;Storage.prototype.setItem=function(e,n){return"oqtima_tab_language"===e&&"ar"===sessionStorage.getItem("oqtima_tab_language")&&"ar"!==n||"oqtima_tab_rtl"===e&&"ar"===sessionStorage.getItem("oqtima_tab_language")&&"false"===n?(console.warn(`[OQtima] Prevented changing ${e} from Arabic RTL setting`),void("oqtima_tab_language"===e&&"ar"!==n&&(console.warn(`[OQtima] Attempt to change language from ar to ${n} blocked`),setTimeout(()=>{t.call(sessionStorage,"oqtima_tab_rtl","true"),t.call(sessionStorage,"oqtima_tab_language","ar"),t.call(sessionStorage,"isRTL","true"),t.call(sessionStorage,"i18nextLng","ar")},0)))):t.call(this,e,n)}}}catch(t){console.warn("[OQtima] Failed to protect Arabic RTL settings:",t)}}if(!window.__LANGUAGE_PROTECTION_ACTIVE&&t){window.__LANGUAGE_PROTECTION_ACTIVE=!0,window.__PROTECTED_LANGUAGE=t.toLowerCase().trim();try{window.__ORIGINAL_SET_ITEM||(window.__ORIGINAL_SET_ITEM=Storage.prototype.setItem),Storage.prototype.setItem=function(t,e){if("oqtima_tab_language"===t||"language"===t||"lang"===t||"i18nextLng"===t){const n=sessionStorage.getItem("oqtima_tab_language")||window.__PROTECTED_LANGUAGE;if(n&&e&&e.toLowerCase()!==n.toLowerCase()&&(console.warn(`[OQtima] Prevented changing ${t} from "${n}" to ${e}`),"oqtima_tab_language"===t))return window.__ORIGINAL_SET_ITEM.call(this,t,n)}return window.__ORIGINAL_SET_ITEM.call(this,t,e)}}catch(t){console.warn("[OQtima] Could not set up language protection:",t)}}let s=(t||"en").toLowerCase().trim();if(/^(br|pt[-_]?br)$/i.test(s)){s="br";try{sessionStorage.setItem("oqtima_tab_language","br"),sessionStorage.setItem("i18nextLng","br"),sessionStorage.setItem("lang","br"),sessionStorage.setItem("language","br"),sessionStorage.setItem("oqtima_final_language","br"),window.__OQTIMA_LANG_MUST_USE="br",window.__OQTIMA_LOCKED_LANG="br",window.__FORCE_LANGUAGE="br";try{localStorage.setItem("i18nextLng","br"),localStorage.setItem("language","br")}catch(t){console.warn("[OQtima] Local storage error for BR language:",t)}document.cookie="i18next=br;path=/;max-age=3600",document.cookie="language=br;path=/;max-age=3600",document.cookie="lang=br;path=/;max-age=3600"}catch(t){console.warn("[OQtima] Error setting BR language storage:",t)}}else s=s.replace(/[^a-z]/g,"");window.__OQTIMA_COMPONENT_LANGUAGE=s,window.__OQTIMA_LOCKED_LANG=s,window.__PROTECTED_LANGUAGE=s,window.__LAST_IFRAME_LANGUAGE=s;let c=n,m=o;if(null!=n){const t=parseInt(n,10);isNaN(t)||(c=t)}null!=o&&(m=String(o));const d="ar"===s||s.startsWith("ar-")||"arabic"===s;if("undefined"!=typeof window)try{sessionStorage.setItem("oqtima_popup_iframe_rtl",d?"true":"false"),window.__OQTIMA_POPUP_IFRAME_RTL__=d,_()&&!r.originalHtmlDir&&p()}catch(t){console.warn("[OQtima] Could not store iframe RTL state:",t)}let u;try{const t=document.getElementsByTagName("script"),n=["registration-popup-script.js","registration-popup-script.min.js"],o=Array.from(t).find(t=>{const e=t.src||"";return n.some(t=>e.includes(t))});if(o&&o.src){const t=new URL(o.src);u=t.origin}else u=e.replace(/\/+$/,"")}catch(t){console.warn("[OQtima] Error determining base URL from script:",t),u=e.replace(/\/+$/,"")}u=u.replace(/\/+$/,"");let g="en"!==s?`/${s}/popup-registration`:"/popup-registration",f=s;if("undefined"!=typeof window)try{sessionStorage.setItem("oqtima_tab_language",f),window.__OQTIMA_COMPONENT_LANGUAGE=f,window.__OQTIMA_LOCKED_LANG=f}catch(t){console.warn("[OQtima] Could not store language in sessionStorage:",t)}const w=new URLSearchParams({popup:"true",clean:"true",hideHeader:"true",hideFooter:"true",hideNav:"true",hideExtras:"true",embedded:"true",standalone:"true",formOnly:"true",minimal:"true",cleanLayout:"true",allowScroll:"true",allowCrossDomain:"true",crossSite:"true",crossOrigin:"anonymous",oqtima_lang_locked:s,force_language:"true",forceLanguage:"true",__force_language:"true",linkHelper:"true",_t:Date.now()});w.append("data-lang",s),w.append("lang_param",s);try{sessionStorage.setItem("oqtima_tab_language",s),window.__OQTIMA_TAB_LANGUAGE__=s;(()=>{try{const t=new URL(u).hostname;if(document.cookie=`oqtima_tab_language=${s}; path=/; max-age=3600; SameSite=None; Secure`,document.cookie=`oqtima_tab_language=${s}; path=/; domain=${t}; max-age=3600; SameSite=None; Secure`,-1!==t.indexOf(".")){const e=t.substring(t.indexOf("."));document.cookie=`oqtima_tab_language=${s}; path=/; domain=${e}; max-age=3600; SameSite=None; Secure`}}catch(t){console.warn("[OQtima] Could not set cross-domain cookies for language:",t)}})()}catch(t){console.warn("[OQtima] Could not store language in sessionStorage:",t)}if(["oqtima_lang_locked","oqtima_lang","language","lang","locale","langParam","selectedLanguage","i18nextLng"].forEach(t=>{w.append(t,s)}),d&&(w.append("isRtl","true"),w.append("forceRtl","true"),w.append("direction","rtl"),w.append("dir","rtl"),w.append("textDirection","rtl"),w.append("oqtima_rtl","true"),w.append("layout","rtl"),w.append("uiMode","rtl")),a){if(w.append("isMobile","true"),w.append("mobileView","true"),w.append("mobileScroll","true"),null!=c&&""!==c){w.append("referral_type",c),w.append("referralType",c),w.append("referral-type",c);try{sessionStorage.setItem("oqtima_referral_type",c),window.__OQTIMA_REFERRAL_TYPE__=c}catch(t){console.warn("[Mobile] Error storing referral_type:",t)}}if(null!=m&&""!==m){w.append("referral_value",m),w.append("referralValue",m),w.append("referral-value",m);try{sessionStorage.setItem("oqtima_referral_value",m),window.__OQTIMA_REFERRAL_VALUE__=m}catch(t){console.warn("[Mobile] Error storing referral_value:",t)}}}if(null!=c&&""!==c&&void 0!==c){["referral_type","referralType","referral-type"].forEach(t=>{w.set(t,c)})}if(null!=m&&""!==m&&void 0!==m&&null!=c&&""!==c&&void 0!==c){["referral_value","referralValue","referral-value"].forEach(t=>{w.set(t,m)});try{window.__OQTIMA_REFERRAL_VALUE__=m,sessionStorage.setItem("oqtima_referral_value",m);(()=>{let t;try{if(t=new URL(u).hostname,document.cookie=`oqtima_referral_value=${m}; path=/; max-age=3600; SameSite=None; Secure`,document.cookie=`oqtima_referral_value=${m}; path=/; domain=${t}; max-age=3600; SameSite=None; Secure`,-1!==t.indexOf(".")){const e=t.substring(t.indexOf("."));document.cookie=`oqtima_referral_value=${m}; path=/; domain=${e}; max-age=3600; SameSite=None; Secure`}}catch(t){console.warn("[OQtima] Could not set cross-domain cookies for referral_value:",t),document.cookie=`oqtima_referral_value=${m}; path=/; max-age=3600`}})()}catch(t){console.warn("[OQtima] Could not store referral value:",t)}}else try{sessionStorage.removeItem("oqtima_referral_value"),void 0!==window.__OQTIMA_REFERRAL_VALUE__&&delete window.__OQTIMA_REFERRAL_VALUE__,document.cookie="oqtima_referral_value=; path=/; max-age=0";try{if(u){const t=new URL(u).hostname;if(document.cookie=`oqtima_referral_value=; path=/; domain=${t}; max-age=0`,-1!==t.indexOf(".")){const e=t.substring(t.indexOf("."));document.cookie=`oqtima_referral_value=; path=/; domain=${e}; max-age=0`}}}catch(t){console.warn("[OQtima] Could not clear domain cookies:",t)}}catch(t){console.warn("[OQtima] Could not clear referral value:",t)}return`${u}${g}?${w.toString()}#registration-form`}function m(t){try{t.target;try{const t=document.createElement("script");t.type="text/javascript",t.innerHTML="\n            (function() {\n              // Function to enhance and handle policy links\n              function enhancePolicyLinks() {\n                // Add CSS to make policy links more visible\n                const style = document.createElement('style');\n                style.innerHTML = \n                  '.popup-registration__consent .link, ' +\n                  'a[href*=\"policy\"], a[href*=\"terms\"], a[href*=\"privacy\"], a[href*=\"cookie\"] { ' +\n                  '  color: #ff4400 !important; ' +\n                  '  text-decoration: underline !important; ' +\n                  '  cursor: pointer !important; ' +\n                  '  margin: 0 4px !important; ' +\n                  '  transition: all 0.2s !important; ' +\n                  '} ' +\n                  '.popup-registration__consent .link:hover, ' +\n                  'a[href*=\"policy\"]:hover, a[href*=\"terms\"]:hover, ' +\n                  'a[href*=\"privacy\"]:hover, a[href*=\"cookie\"]:hover { ' +\n                  '  color: #cc3600 !important; ' +\n                  '  text-decoration: underline !important; ' +\n                  '} ' +\n                  '.popup-registration__consent { ' +\n                  '  display: block !important; ' +\n                  '  margin: 16px 0 !important; ' +\n                  '  line-height: 1.5 !important; ' +\n                  '}';\n                document.head.appendChild(style);\n                \n                // Tracking variables for link handling\n                let processingLink = false;\n                let linkTimeout = null;\n                \n                // Handle all link clicks through event delegation\n                document.addEventListener('click', function(e) {\n                  // Find policy links\n                  const link = e.target.closest('a.link, a[href*=\"policy\"], a[href*=\"terms\"], a[href*=\"privacy\"], a[href*=\"cookie\"]');\n                  \n                  if (link && link.href) {\n                    // Check if it matches a policy link pattern\n                    if (/policy|privacy|cookie|terms|legal|disclaimer/.test(link.href)) {\n                      e.preventDefault();\n                      \n                      // Don't process if already handling a link\n                      if (processingLink) return false;\n                      \n                      // Mark as processing\n                      processingLink = true;\n                      \n                      // Store original link text\n                      const originalText = link.innerHTML;\n                      \n                      // Add loading indicator\n                      link.innerHTML = originalText + ' <span style=\"display: inline-block; animation: pulse 1s infinite;\">...</span>';\n                      \n                      // Determine policy type\n                      const policyType = \n                        link.href.toLowerCase().includes('privacy') ? 'Privacy' :\n                        link.href.toLowerCase().includes('cookie') ? 'Cookie' :\n                        link.href.toLowerCase().includes('terms') ? 'Terms' : 'Policy';\n                      \n                      // Send message to parent window\n                      try {\n                        window.parent.postMessage({\n                          type: 'OQTIMA_OPEN_LINK',\n                          url: link.href,\n                          isPolicyLink: true,\n                          policyType: policyType.toLowerCase(),\n                          timestamp: Date.now()\n                        }, '*');\n                        \n                        // Set fallback timeout\n                        linkTimeout = setTimeout(function() {\n                          // Try direct fallback if parent doesn't respond\n                          processingLink = false;\n                          link.innerHTML = originalText;\n                          \n                          try {\n                            // Try to open directly\n                            window.open(link.href, '_blank');\n                          } catch(err) {\n                            // console.log('Both parent and direct open failed');\n                            \n                            // Make the link more prominent as last resort\n                            link.style.color = '#ff4400';\n                            link.style.fontWeight = 'bold';\n                            link.innerHTML = originalText + ' (click again)';\n                            \n                            // Create fallback button\n                            const fallback = document.createElement('a');\n                            fallback.href = link.href;\n                            fallback.target = '_blank';\n                            fallback.style.position = 'fixed';\n                            fallback.style.bottom = '20px';\n                            fallback.style.left = '20px';\n                            fallback.style.background = '#ff4400';\n                            fallback.style.color = 'white';\n                            fallback.style.padding = '10px 15px';\n                            fallback.style.borderRadius = '4px';\n                            fallback.style.textDecoration = 'none';\n                            fallback.style.fontWeight = 'bold';\n                            fallback.style.zIndex = '999999';\n                            fallback.style.boxShadow = '0 2px 8px rgba(0,0,0,0.2)';\n                            fallback.textContent = 'Open ' + policyType + ' Policy';\n                            \n                            document.body.appendChild(fallback);\n                            \n                            // Remove after 15 seconds\n                      setTimeout(function() {\n                              if (fallback.parentNode) {\n                                fallback.parentNode.removeChild(fallback);\n                              }\n                            }, 15000);\n                          }\n                        }, 1000);\n                      } catch(err) {\n                        // Reset on error\n                        processingLink = false;\n                        link.innerHTML = originalText;\n                        \n                        // Try direct open\n                        try {\n                          window.open(link.href, '_blank');\n                        } catch(err2) {\n                          // console.log('Link open failed completely');\n                        }\n                      }\n                      \n                      return false;\n                    }\n                  }\n                });\n                \n                // Listen for parent window response\n                window.addEventListener('message', function(event) {\n                  if (event.data && event.data.type === 'OQTIMA_LINK_OPENED') {\n                    // Clear timeout and reset state\n                    clearTimeout(linkTimeout);\n                    processingLink = false;\n                    \n                    // Find all policy links matching the URL\n                    const links = document.querySelectorAll('a.link, a[href*=\"policy\"], a[href*=\"terms\"], a[href*=\"privacy\"], a[href*=\"cookie\"]');\n                    links.forEach(function(link) {\n                      // Reset any links with loading indicators\n                      if (link.querySelector('span') && link.innerHTML.includes('...')) {\n                        // Remove any loading indicators\n                        link.innerHTML = link.innerHTML.replace(/ <span style=\"display: inline-block; animation: pulse 1s infinite;\">...<\\/span>/, '');\n                      }\n                    });\n                  }\n                });\n              }\n              \n              // Initialize right away\n              enhancePolicyLinks();\n            })();\n          ",document.head.appendChild(t)}catch(t){console.warn("Failed to inject link handler script:",t)}}catch(t){}}if("loading"===document.readyState)document.addEventListener("DOMContentLoaded",()=>{const t=document.querySelectorAll("[data-oqtima-register]"),e=document.querySelectorAll("[data-oqtima-trigger]");t.length>0||e.length>0?(t.length>0&&d(t),a()):console.warn("No registration elements found (neither [data-oqtima-register] nor [data-oqtima-trigger])")});else{const t=document.querySelectorAll("[data-oqtima-register]"),e=document.querySelectorAll("[data-oqtima-trigger]");t.length>0||e.length>0?(t.length>0&&d(t),a()):console.warn("No registration elements found (neither [data-oqtima-register] nor [data-oqtima-trigger])")}function d(t){let e="en";try{if(sessionStorage.getItem("oqtima_tab_language"))e=sessionStorage.getItem("oqtima_tab_language");else if(document.documentElement.lang)e=document.documentElement.lang.toLowerCase();else if(window.location.pathname){const t=window.location.pathname.split("/").filter(Boolean);t.length>0&&/^[a-z]{2}(-[a-z]{2})?$/.test(t[0])&&(e=t[0].toLowerCase())}else navigator.language&&(e=navigator.language.split("-")[0].toLowerCase())}catch(t){}t.forEach(t=>{const n=t.getAttribute("data-text")||"GET STARTED",o=t.getAttribute("data-lang")||e;let r=t.getAttribute("data-referral-type");const a=t.getAttribute("data-referral-value");if(r){const t=parseInt(r,10);isNaN(t)||(r=t)}t.setAttribute("dir","ltr"),t.style.direction="ltr",t.style.textAlign="",t.setAttribute("data-lang",o),t.innerHTML=`\n        <button \n          type="button" \n          data-lang="${o}"\n          class="oqtima-registration-button" \n          style="\n            display: inline-block !important;\n            visibility: visible !important;\n            opacity: 1 !important;\n            padding: 14px 25px !important;\n            background-color: #ff4400 !important;\n            color: white !important;\n            border: none !important;\n            border-radius: 50px !important;\n            font-size: 20px !important;\n            font-weight: 600 !important;\n            cursor: pointer !important;\n            position: relative !important;\n            z-index: 99999 !important;\n            margin: 10px !important;\n            pointer-events: auto !important;\n            transition: all 0.3s ease-in-out !important;\n            text-align: center !important;\n            text-decoration: none !important;\n            box-shadow: 0 4px 6px rgba(255, 68, 0, 0.1) !important;\n            direction: ltr !important;\n          "\n        >${n}</button>\n      `;const i=t.querySelector(".oqtima-registration-button");i&&(i.setAttribute("data-lang",o),i.setAttribute("dir","ltr"),i.addEventListener("click",function(t){if(t.preventDefault(),window.sessionStorage)try{sessionStorage.setItem("oqtima_popup_mode","true");const t=12===r||14===r;t?r&&t&&(sessionStorage.setItem("oqtima_referral_type",r),a?sessionStorage.setItem("oqtima_referral_value",a):null!==sessionStorage.getItem("oqtima_referral_value")&&sessionStorage.removeItem("oqtima_referral_value")):(null!==sessionStorage.getItem("oqtima_referral_type")&&sessionStorage.removeItem("oqtima_referral_type"),null!==sessionStorage.getItem("oqtima_referral_value")&&sessionStorage.removeItem("oqtima_referral_value"))}catch(t){console.warn("Error storing parameters in sessionStorage:",t)}window.__OQTIMA_REFERRAL_TYPE__=r,window.__OQTIMA_REFERRAL_VALUE__=a,l({lang:o,referral_type:r,referral_value:a,preserveParentDirection:!0})}))})}function p(){try{if("undefined"==typeof document)return;r.originalHtmlDir=document.documentElement.getAttribute("dir"),r.originalHtmlLang=document.documentElement.getAttribute("lang"),r.originalHtmlClasses=document.documentElement.className,r.originalHtmlRtl=document.documentElement.getAttribute("data-rtl"),r.originalBodyDir=document.body.getAttribute("dir"),r.originalBodyClasses=document.body.className,r.originalBodyRtl=document.body.getAttribute("data-rtl")}catch(t){console.error("[OQtima] Error saving RTL state:",t)}}function u(){try{if("undefined"==typeof document)return;r.originalHtmlDir&&document.documentElement.setAttribute("dir",r.originalHtmlDir),r.originalHtmlLang&&document.documentElement.setAttribute("lang",r.originalHtmlLang),document.documentElement.className=r.originalHtmlClasses||"",r.originalHtmlRtl&&document.documentElement.setAttribute("data-rtl",r.originalHtmlRtl),r.originalBodyDir&&document.body.setAttribute("dir",r.originalBodyDir),document.body.className=r.originalBodyClasses||"",r.originalBodyRtl&&document.body.setAttribute("data-rtl",r.originalBodyRtl)}catch(t){console.error("[OQtima] Error restoring RTL state:",t)}}function _(){if("undefined"==typeof document)return!1;const t=document.documentElement.getAttribute("dir"),e=document.documentElement.className||"",n=document.body.getAttribute("dir"),o=document.body.className||"";return"rtl"===t||"rtl"===n||e.includes("rtl")||o.includes("rtl")}function g(){try{if(window.__OQTIMA_INITIALIZED__)return;if(!document.querySelector("style#oqtima-registration-styles")){const t=document.createElement("style");t.id="rtl-inline-styles",t.innerHTML='\n          .rtl-active input, \n          .rtl-active textarea, \n          .rtl-active select {\n            direction: rtl !important;\n            text-align: right !important;\n          }\n          \n          .rtl-active .form-item {\n            direction: rtl !important; \n          }\n          \n          .rtl-active .popup-registration__content {\n            direction: rtl !important;\n          }\n          \n          /* Ensure buttons maintain center text alignment in RTL mode */\n          .rtl-active button,\n          .rtl-active .button,\n          .rtl-active input[type="submit"],\n          .rtl-active input[type="button"],\n          .rtl-active .submit-button,\n          .rtl-active .form-button {\n            text-align: center !important;\n          }\n          \n          /* Specifically target the submit buttons */\n          .rtl-active .popup-registration__button-submit,\n          .rtl-active form button[type="submit"],\n          .rtl-active button.submit-registration {\n            text-align: center !important;\n          }\n          \n          .rtl-active .popup-registration__container {\n            display: flex !important;\n            flex-direction: row-reverse !important;\n          }\n\n          .rtl-active .popup-registration__sidebar {\n            order: 2 !important;\n            border-radius: 0 10px 10px 0 !important;\n          }\n\n          .rtl-active .popup-registration__content {\n            order: 1 !important;\n            border-radius: 10px 0 0 10px !important;\n          }\n          \n          /* For mobile devices */\n          @media (max-width: 767px) {\n            .rtl-active .popup-registration__container {\n              flex-direction: column !important;\n            }\n            \n            .rtl-active .popup-registration__sidebar {\n              border-radius: 10px 10px 0 0 !important;\n            }\n            \n            .rtl-active .popup-registration__content {\n              border-radius: 0 0 10px 10px !important;\n            }\n          }\n          \n          /* Mirror spacing and positioning */\n          .rtl-active .form-item label {\n            text-align: right !important;\n          }\n        ',document.head.appendChild(t)}window.__OQTIMA_INITIALIZED__=!0}catch(t){}}window.__OQTIMA_EMERGENCY_RESTORE_SCROLL=function(){try{document.body.style.position="",document.body.style.width="",document.body.style.top="",document.body.style.overflow="",document.documentElement.style.overflow="",document.body.classList.remove("oqtima-iframe-open"),document.body.classList.remove("oqtima-mobile-open"),document.body.classList.remove("popup-open"),document.documentElement.classList.remove("oqtima-mobile-open"),document.body.classList.remove("oqtima-mobile-modal-open"),document.documentElement.classList.remove("oqtima-mobile-popup-open"),document.body.classList.remove("oqtima-mobile-popup-open");const t=document.querySelector(".popup-registration");t&&t.parentNode&&t.parentNode.removeChild(t);const e=document.querySelector(".oqtima-loading-overlay");e&&e.parentNode&&e.parentNode.removeChild(e)}catch(t){}},window.OqtimaRegistration={init:g,openRegistrationPopup:l,initOqtimaRegistration:a,trigger:function(t={}){if(void 0!==t.referralType&&void 0===t.referral_type&&(t.referral_type=t.referralType),void 0!==t.referralValue&&void 0===t.referral_value&&(t.referral_value=t.referralValue),t.lang=t.lang||t.language||"en",window.sessionStorage)try{sessionStorage.setItem("oqtima_popup_mode","true"),t.referral_type&&sessionStorage.setItem("oqtima_referral_type",t.referral_type),t.referral_value&&sessionStorage.setItem("oqtima_referral_value",t.referral_value)}catch(t){}window.__OQTIMA_REFERRAL_TYPE__=t.referral_type,window.__OQTIMA_REFERRAL_VALUE__=t.referral_value,l(t)}},"complete"===document.readyState||"interactive"===document.readyState?setTimeout(g,0):(document.addEventListener("DOMContentLoaded",g),window.addEventListener("load",function(){window.__OQTIMA_INITIALIZED__||g()})),"true"!==urlParams.get("referral_popup")&&"true"!==urlParams.get("open_registration")||apiKey&&(window.__OQTIMA_AUTO_OPEN_POPUP=!0,window.__OQTIMA_URL_PARAM_LANG=urlParams.get("lang")||urlParams.get("language")||urlParams.get("i18nextLng")||"en",urlParams.get("referral_type")&&(window.__OQTIMA_URL_REFERRAL_TYPE=urlParams.get("referral_type")),urlParams.get("referral_value")&&(window.__OQTIMA_URL_REFERRAL_VALUE=urlParams.get("referral_value")))}();